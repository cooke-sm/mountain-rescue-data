date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
}
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
incident
}
sort_data(test[1])
sort_data(test[2])
sort_data(test[3])
sort_data(test[4])
sort_data(test[4])
test[[1]] -> int
sort_data(test[4])
test[[2]] -> int
test[2] -> int
int
test[3] -> int
View(test)
sort_data(smaller[1])
sort_data(smaller[2])
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
str_c(date, loc, n_incident, incident, sep = " <-> ")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
str_c(date, loc, n_incident, unlist(incident), sep = " <-> ")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
str_c(date, loc, n_incident, str_c(incident), sep = " <-> ")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
str_c(date, loc, n_incident, str_c(incident), sep = " <-> ")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
unlist(incident)
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
str(incident)
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
str_c(incident)
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
str_c(incident)
}
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
is.vector(incident)
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
cat(incident)
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(parse_date(x[str_detect(x, "team")], "%+ %d/%m/%Y"), "\\d+ team")
hrs <- str_extract(parse_date(x[str_detect(x, "hours")], "%+ %d/%m/%Y"), "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- cat(x[2:(length(x)-2)])
str_c(date, n_team, hrs, loc, n_incident, incident, sep = "<->")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- cat(x[2:(length(x)-2)])
str_c(date, n_team, hrs, loc, n_incident, incident, sep = "<->")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)])
str_c(date, n_team, hrs, loc, n_incident, incident, sep = "<->")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- unlist(x[2:(length(x)-2)])
str_c(date, n_team, hrs, loc, n_incident, incident, sep = "<->")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
str_c(date, n_team, hrs, loc, n_incident, incident, sep = "<->")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
incident
#str_c(date, n_team, hrs, loc, n_incident, incident, sep = "<->")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
str_c(incident)
#str_c(date, n_team, hrs, loc, n_incident, incident, sep = "<->")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
str(incident)
#str_c(date, n_team, hrs, loc, n_incident, incident, sep = "<->")
}
sort_data(smaller[3])
a <- c("a","b","C")
a
str_c(a)
str_c(a, collapse = " - ")
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- x[2:(length(x)-2)]
str_c(date, n_team, hrs, loc, n_incident, incident, collapse = "<->")
}
sort_data(smaller[3])
}
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " - ")
str_c(date, n_team, hrs, loc, n_incident, incident, collapse = "<->")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " - ")
incident
#str_c(date, n_team, hrs, loc, n_incident, incident, collapse = "<->")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = "")
incident
#str_c(date, n_team, hrs, loc, n_incident, incident, collapse = "<->")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
incident
#str_c(date, n_team, hrs, loc, n_incident, incident, collapse = "<->")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
str_c(date, n_team, hrs, loc, n_incident, incident)
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
str_c(date, n_team, hrs, loc, n_incident, incident, collapse = "")
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
str(incident)
#str_c(date, n_team, hrs, loc, n_incident, incident, collapse = )
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
str(date)
#str_c(date, n_team, hrs, loc, n_incident, incident, collapse = )
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
str(n_team)
#str_c(date, n_team, hrs, loc, n_incident, incident, collapse = )
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "\\d+ team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
str(n_team)
#str_c(date, n_team, hrs, loc, n_incident, incident, collapse = )
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "\\d+ team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "\\d+ hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
str(n_team)
#str_c(date, n_team, hrs, loc, n_incident, incident, collapse = )
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "\\d+ team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "\\d+ hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
str_c(date, n_team, hrs, loc, n_incident, incident, collapse = )
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "\\d+ team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "\\d+ hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
c(date, n_team, hrs, loc, n_incident, incident)
}
sort_data(smaller[3])
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "\\d+ team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "\\d+ hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
list(date, n_team, hrs, loc, n_incident, incident)
}
sort_data(smaller[3])
list(date = date, n_team = n_team, hrs = hrs, lco = loc, n_incident = n_incident,incident = incident)
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "\\d+ team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "\\d+ hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
list(date = date, n_team = n_team, hrs = hrs, lco = loc, n_incident = n_incident,incident = incident)
}
sort_data(smaller[3])
?append()
lapply(smaller, sort_data)
tes <- lapply(smaller, sort_data)
View(tes)
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "\\d+ team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "\\d+ hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
list(date = date, n_team = n_team, hrs = hrs, loc = loc, n_incident = n_incident,incident = incident)
}
sort_data <- function(list){
x <- unlist(list)
date <- parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y")
n_team <- str_extract(x[str_detect(x, "\\d+ team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "\\d+ hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
list(date = date, n_team = n_team, hrs = hrs, loc = loc, n_incident = n_incident,incident = incident)
}
tes <- lapply(smaller, sort_data)
data <- as_tibble(tes)
data <- as_tibble_row(tes)
data <- tibble(date = map(output, "date"),
n_team = map(output, "n_team"),
hrs = map(output, "hrs"),
loc = map(output, "loc"),
n_incident = map(output, "n_incident"),
incident = map(output, "incident"))
sort_data <- function(list){
x <- unlist(list)
date <- suppressWarnings(parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y"))
n_team <- str_extract(x[str_detect(x, "\\d+ team")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "\\d+ hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
list(date = date, n_team = n_team, hrs = hrs, loc = loc, n_incident = n_incident,incident = incident)
}
output <- lapply(smaller, sort_data)
data <- tibble(date = map(output, "date"),
n_team = map(output, "n_team"),
hrs = map(output, "hrs"),
loc = map(output, "loc"),
n_incident = map(output, "n_incident"),
incident = map(output, "incident"))
View(data)
sort_data <- function(list){
x <- unlist(list)
date <- suppressWarnings(parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y"))
n_team <- str_extract(x[str_detect(x, "\\d+ team members")], "\\d+ team")
hrs <- str_extract(x[str_detect(x, "\\d+ hours")], "\\d+ hours")
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
list(date = date, n_team = n_team, hrs = hrs, loc = loc, n_incident = n_incident,incident = incident)
}
output <- lapply(smaller, sort_data)
data <- tibble(date = map(output, "date"),
n_team = map(output, "n_team"),
hrs = map(output, "hrs"),
loc = map(output, "loc"),
n_incident = map(output, "n_incident"),
incident = map(output, "incident"))
View(data)
sort_data <- function(list){
x <- unlist(list)
date <- suppressWarnings(parse_date(x[str_detect(x, "Callout")], "%+ %d/%m/%Y"))
n_team <- parse_number(str_extract(x[str_detect(x, "\\d+ team members")], "\\d+ team"))
hrs <- parse_number(str_extract(x[str_detect(x, "\\d+ hours")], "\\d+ hours"))
loc <- x[length(x)]
n_incident <- x[length(x)-1]
incident <- str_c(x[2:(length(x)-2)], collapse = " ")
list(date = date, n_team = n_team, hrs = hrs, loc = loc, n_incident = n_incident,incident = incident)
}
output <- lapply(smaller, sort_data)
data <- tibble(date = map(output, "date"),
n_team = map(output, "n_team"),
hrs = map(output, "hrs"),
loc = map(output, "loc"),
n_incident = map(output, "n_incident"),
incident = map(output, "incident"))
View(data)
data %>%
select(incident, n_incident, loc) %>%
write_csv("keswick_data.csv")
data %>% ggplot(aes(x=loc))+
geom_bar()
head(data)
data <- tibble(date = map(output, "date"),
n_team = map(output, "n_team"),
loc = map(output, "loc"),
n_incident = map(output, "n_incident"),
incident = map(output, "incident")) %>%
mutate(incident = map_chr(incident,1),
loc = map_chr(loc,1),
incident_n = parse_number(str_extract(incident, "(i|I)ncident \\d+")),
n_team = parse_number(str_extract(n_team,"\\d+")),
date = parse_date(str_extract(date, "(?<=:).*"), "%+ %d %b %Y"))
View(data)
data %>%
select(incident, n_incident, loc) %>%
write_csv("keswick_data.csv")
data %>% ggplot(aes(x=loc))+
geom_bar()
data %>% count(loc) %>%
arrange(desc(n))
data %>%
filter(loc == "catbells") %>%
view()
